<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Курс по FlySky FS-i6S</title>
    <!-- Подключаем Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Добавляем иконки (для звезд) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <style>
        /* Используем современный шрифт Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Стили для скроллбара */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748; /* bg-gray-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568; /* bg-gray-600 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096; /* bg-gray-500 */
        }

        /* Стиль для активной кнопки навигации */
        .nav-button.active {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
            font-weight: 600;
        }

        /* Стили для кнопок ответа */
        .option-button:disabled {
            opacity: 0.8;
            cursor: not-allowed;
        }
        .option-button.correct {
            background-color: #16a34a; /* bg-green-600 */
            color: white;
            border-color: #15803d;
        }
        .option-button.incorrect {
            background-color: #dc2626; /* bg-red-600 */
            color: white;
            border-color: #b91c1c;
        }
        
        /* Стили для информационных блоков */
        #info-content h2 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 0.75rem; /* mb-3 */
            border-bottom: 1px solid #4a5568; /* border-b border-gray-600 */
            padding-bottom: 0.5rem; /* pb-2 */
        }
        #info-content p {
            margin-bottom: 1rem; /* mb-4 */
            line-height: 1.6; /* leading-relaxed */
        }
        #info-content ul {
            list-style-type: disc;
            margin-left: 1.5rem; /* ml-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        #info-content li {
            margin-bottom: 0.5rem; /* mb-2 */
        }
        #info-content strong {
            color: #60a5fa; /* text-blue-400 */
        }
        #info-content code {
            background-color: #4a5568; /* bg-gray-600 */
            padding: 0.125rem 0.375rem; /* px-1.5 py-0.5 */
            border-radius: 0.25rem; /* rounded */
            font-family: monospace;
        }
        #info-content img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem; /* rounded-lg */
            margin-top: 1rem;
            margin-bottom: 1rem;
            border: 2px solid #4a5568; /* border-2 border-gray-600 */
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex flex-col min-h-screen">

    <!-- Заголовок и счетчик звезд -->
    <header class="bg-gray-800 shadow-lg p-4 flex justify-between items-center w-full z-10">
        <h1 class="text-xl md:text-2xl font-bold text-white">
            Интерактивный курс: <span class="text-blue-400">FlySky FS-i6S</span>
        </h1>
        <div id="star-counter" class="text-xl md:text-2xl font-bold text-yellow-400 flex items-center">
            <i class="fas fa-star mr-2"></i>
            <span id="star-count">0</span> / <span id="star-total">0</span>
        </div>
    </header>

    <div class="flex flex-1 flex-col md:flex-row overflow-hidden">
        
        <!-- Боковая навигация -->
        <nav id="navigation-bar" class="w-full md:w-1/4 lg:w-1/5 bg-gray-800 p-4 overflow-y-auto border-t md:border-t-0 md:border-r border-gray-700">
            <h2 class="text-lg font-semibold mb-4 text-white">Блоки курса</h2>
            <!-- Кнопки навигации будут вставлены сюда -->
        </nav>

        <!-- Основной контент -->
        <main class="flex-1 p-4 md:p-8 overflow-y-auto" style="scroll-behavior: smooth;">
            <!-- Заголовок блока -->
            <h1 id="content-title" class="text-3xl font-bold mb-6 text-white border-b-2 border-blue-500 pb-2"></h1>

            <!-- Вкладки Теория / Тест -->
            <div class="mb-4 border-b border-gray-700">
                <nav class="flex space-x-4" aria-label="Tabs">
                    <button id="tab-info" class="tab-button active text-blue-400 border-blue-400 px-3 py-2 font-medium text-sm rounded-t-lg border-b-2">
                        <i class="fas fa-book-open mr-2"></i>Теория
                    </button>
                    <button id="tab-quiz" class="tab-button text-gray-400 hover:text-gray-200 px-3 py-2 font-medium text-sm rounded-t-lg border-b-2 border-transparent hover:border-gray-500">
                        <i class="fas fa-question-circle mr-2"></i>Тест
                    </button>
                </nav>
            </div>

            <!-- Контент Теории -->
            <div id="info-container">
                <div id="info-content" class="bg-gray-800 p-6 rounded-lg shadow-inner">
                    <!-- Содержание блока (теория) будет здесь -->
                </div>
                <button id="start-quiz-btn" class="mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                    Начать тест! <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>

            <!-- Контент Теста -->
            <div id="quiz-container" class="hidden">
                <div id="quiz-content" class="bg-gray-800 p-6 rounded-lg shadow-inner">
                    <!-- Вопросы теста будут здесь -->
                </div>
                <div class="mt-8 flex justify-between">
                    <button id="prev-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                        <i class="fas fa-arrow-left mr-2"></i> Назад
                    </button>
                    <button id="next-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                        Далее <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- Модальное окно завершения -->
            <div id="completion-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
                <div class="bg-gray-800 p-8 rounded-lg shadow-2xl text-center max-w-md mx-4">
                    <i class="fas fa-trophy text-yellow-400 text-6xl mb-6"></i>
                    <h2 class="text-3xl font-bold text-white mb-4">Курс пройден!</h2>
                    <p class="text-lg text-gray-300 mb-6">
                        Поздравляем, ты прошел весь курс и показал отличные знания! Ты настоящий пилот!
                    </p>
                    <p class="text-2xl font-bold text-yellow-400 mb-8">
                        Твой результат: <span id="final-score"></span>
                    </p>
                    <button id="restart-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                        Пройти заново
                    </button>
                </div>
            </div>

        </main>
    </div>

    <script type="module">
        // --- БАЗА ДАННЫХ КУРСА ---
        // Весь ваш текст, преобразованный в структуру данных
        const courseData = [
            // Блок 1
            {
                title: "Блок 1: Что такое пульт и почему это важно?",
                info: `
                    <h2>Привет, будущий пилот!</h2>
                    <p>Перед тобой не просто джойстик, а "мозг" твоего дрона или авиамодели. Этот пульт называется <strong>аппаратурой радиоуправления</strong>, или просто "аппа". Конкретно эта модель — FlySky FS-i6S.</p>
                    <p>Ее работа — переводить движения твоих пальцев на стиках (джойстиках) в команды, которые по радиосигналу улетают на твой дрон. Дрон принимает эти команды и выполняет их: взлетает, поворачивает, летит вперед.</p>
                    <h2>Самое главное — безопасность!</h2>
                    <p>Дрон — это не игрушка, даже если он маленький. Его винты (пропеллеры) вращаются с огромной скоростью и могут нанести травму или повредить имущество. Твоя главная задача как пилота — обеспечить безопасность себя, окружающих и самого дрона.</p>
                    <h2>Золотые правила пилота:</h2>
                    <ul>
                        <li>Никогда не летай над людьми или животными. Всегда держи дистанцию.</li>
                        <li>Летай только в открытых местах. Подальше от зданий, деревьев и, особенно, линий электропередач (ЛЭП).</li>
                        <li>Всегда держи дрон в поле зрения. Не улетай так далеко, что перестанешь его видеть.</li>
                        <li>Проверяй заряд. Убедись, что батарея заряжена и в пульте, и в самом дроне.</li>
                        <li>Не летай в плохую погоду (дождь, сильный ветер, туман).</li>
                    </ul>
                `,
                questions: [
                    {
                        question: "1. Что такое FlySky FS-i6S?",
                        options: [
                            "А) Это сам дрон",
                            "Б) Это пульт управления, который посылает команды дрону",
                            "В) Это батарейка для дрона"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Какое самое главное правило пилота?",
                        options: [
                            "А) Летать как можно выше",
                            "Б) Обеспечить безопасность",
                            "В) Летать только в помещении"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Почему нельзя летать над людьми?",
                        options: [
                            "А) Они могут испугаться",
                            "Б) Дрон может упасть и травмировать кого-то",
                            "В) Люди могут украсть дрон"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "4. Выбери правильное место для полетов:",
                        options: [
                            "А) Школьный двор во время перемены",
                            "Б) Большое открытое поле вдали от дорог и зданий",
                            "В) Твоя комната"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 2
            {
                title: "Блок 2: Анатомия пульта. Что за что отвечает?",
                info: `
                    <p>Давай посмотрим на пульт. На нем много кнопок и два главных джойстика.</p>
                    <img src="./Снимок экрана 2025-10-22 в 14.22.18.jpg" alt="Пульт FlySky FS-i6S - вид спереди, сбоку и сзади" title="Схема расположения стиков и переключателей">
                    <h2>1. Стики (Sticks)</h2>
                    <p>Это два главных джойстика. Мы используем самый популярный стандарт <strong>"Mode 2"</strong>.</p>
                    <p><strong>Левый стик (Left Stick):</strong></p>
                    <ul>
                        <li><strong>Вверх/Вниз:</strong> Это "Газ" (Throttle). <strong>Важная особенность FS-i6S:</strong> этот стик, как и правый, подпружинен и сам возвращается в центр. Центр — это 0% газа. Движение вверх — это "дать газу" (дрон взлетает). Чтобы висеть, нужно держать стик чуть выше центра. Движение вниз — торможение/снижение.</li>
                        <li><strong>Влево/Вправо:</strong> Это "Рысканье" (Yaw). Дрон поворачивает свой "нос" влево или вправо, оставаясь на месте (как будто крутится на стуле).</li>
                    </ul>
                    <p><strong>Правый стик (Right Stick):</strong></p>
                    <ul>
                        <li><strong>Вверх/Вниз:</strong> Это "Тангаж" (Pitch). Движение вверх наклоняет дрон "носом" вперед, и он летит вперед. Движение вниз — "носом" назад, и он летит назад.</li>
                        <li><strong>Влево/Вправо:</strong> Это "Крен" (Roll). Дрон наклоняется (кренится) боком и летит боком влево или вправо.</li>
                    </ul>
                    <h2>2. Переключатели (Switches)</h2>
                    <p>На "плечах" пульта есть 4 переключателя (тумблера): <code>SwA</code>, <code>SwB</code>, <code>SwC</code>, <code>SwD</code>. Они нужны для включения разных функций.</p>
                    <p>Самая важная функция — <strong>"Arm/Disarm" (Постановка/Снятие с охраны)</strong>.</p>
                    <p>Обычно один из тумблеров (например, <code>SwA</code>) настраивают так, чтобы в одном положении дрон был "безопасен" (винты не крутятся), а в другом — "готов к полету" (винты начинают вращаться).</p>
                    <h2>3. Экран (Screen)</h2>
                    <p>Это сенсорный экран. Он показывает важную информацию:</p>
                    <ul>
                        <li>Заряд батареи пульта.</li>
                        <li>Название модели, которой ты управляешь.</li>
                        <li>Силу сигнала.</li>
                    </ul>
                    <h2>4. Кнопки питания (Power Buttons)</h2>
                    <p>На FS-i6S нужно зажать <strong>обе серебряные кнопки</strong> по бокам экрана, чтобы включить или выключить пульт. Это сделано для защиты от случайного выключения в полете.</p>
                `,
                questions: [
                    {
                        question: "1. Ты хочешь, чтобы твой дрон полетел ВПЕРЕД. Какой стик и в каком направлении ты подвинешь (в режиме Mode 2)?",
                        options: [
                            "А) Левый стик ВВЕРХ",
                            "Б) Правый стик ВВЕРХ",
                            "В) Правый стик ВПРАВО"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Что делает 'Газ' (Throttle)?",
                        options: [
                            "А) Меняет высоту дрона (вверх/вниз)",
                            "Б) Поворачивает дрон (нос влево/вправо)",
                            "В) Наклоняет дрон для полета вперед"
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: "3. Ты хочешь повернуть дрон 'носом' влево, не двигаясь с места. Что ты используешь?",
                        options: [
                            "А) Тангаж (Pitch)",
                            "Б) Крен (Roll)",
                            "В) Рысканье (Yaw)"
                        ],
                        correctAnswer: 2
                    },
                    {
                        question: "4. Для чего нужен переключатель (тумблер) 'Arm/Disarm'?",
                        options: [
                            "А) Чтобы включать свет на дроне",
                            "Б) Чтобы активировать винты для полета или выключить их",
                            "В) Чтобы сделать фото"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 3
            {
                title: "Блок 3: Включаем и 'женим' пульт с дроном",
                info: `
                    <p>Прежде чем лететь, пульт (Передатчик) и дрон (Приемник) должны "узнать" друг друга. Этот процесс называется <strong>"Привязка" (Binding)</strong>. Обычно это делается один раз для одного дрона.</p>
                    <p>Но есть более важный ежедневный ритуал: порядок включения и выключения.</p>
                    <h2>ПРАВИЛО ВКЛЮЧЕНИЯ:</h2>
                    <ol style="list-style-type: decimal; margin-left: 1.5rem; margin-bottom: 1rem;">
                        <li class="mb-2"><strong>Сначала включи ПУЛЬТ</strong> (зажми две кнопки питания).</li>
                        <li class="mb-2">Убедись, что стик газа (левый) в самом нижнем положении.</li>
                        <li class="mb-2">Только потом подключай батарею к ДРОНУ.</li>
                    </ol>
                    <p><strong>Почему?</strong> Если ты включишь дрон первым, а пульт выключен или еще не "нашелся", дрон не получит сигнала "стой!" и может включить моторы на полную мощность.</p>
                    
                    <h2>ПРАВИЛО ВЫКЛЮЧЕНИЯ:</h2>
                    <ol style="list-style-type: decimal; margin-left: 1.5rem; margin-bottom: 1rem;">
                        <li class="mb-2"><strong>Сначала отключи батарею от ДРОНА.</strong></li>
                        <li class="mb-2">Только потом выключи ПУЛЬТ.</li>
                    </ol>
                    <p><strong>Почему?</strong> Если ты выключишь пульт первым, дрон потеряет сигнал. Его "мозг" (полетный контроллер) перейдет в режим "Failsafe" (отказ). В лучшем случае он просто упадет, в худшем — может улететь.</p>
                    <p class="text-lg font-bold bg-gray-700 p-4 rounded-lg">Запомни: Пульт всегда <strong>ПЕРВЫЙ</strong> включается и <strong>ПОСЛЕДНИЙ</strong> выключается.</p>
                `,
                questions: [
                    {
                        question: "1. Что такое 'Привязка' (Binding)?",
                        options: [
                            "А) Процесс зарядки пульта",
                            "Б) Процесс 'знакомства' пульта и приемника на дроне",
                            "В) Процесс калибровки стиков"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Какой правильный порядок ВКЛЮЧЕНИЯ оборудования?",
                        options: [
                            "А) Сначала дрон, потом пульт",
                            "Б) Сначала пульт, потом дрон",
                            "В) Не имеет значения"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Какой правильный порядок ВЫКЛЮЧЕНИЯ оборудования?",
                        options: [
                            "А) Сначала дрон, потом пульт",
                            "Б) Сначала пульт, потом дрон",
                            "В) Не имеет значения"
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: "4. Что может случиться, если сначала выключить пульт, а потом дрон?",
                        options: [
                            "А) Дрон просто плавно сядет",
                            "Б) Ничего, это безопасно",
                            "В) Дрон потеряет сигнал, и пилот потеряет управление"
                        ],
                        correctAnswer: 2
                    }
                ]
            },
            // Блок 4
            {
                title: "Блок 4: Навигация по меню и первая настройка",
                info: `
                    <p>Пульт FS-i6S имеет сенсорный экран, что упрощает настройку. Чтобы войти в меню, просто коснись экрана и проведи пальцем.</p>
                    <p>Две самые важные настройки, которые тебе нужно знать:</p>
                    <h2>1. Model Select (Выбор модели)</h2>
                    <p>В памяти пульта можно хранить настройки для разных дронов (до 20 штук). Если у тебя один гоночный дрон и один самолет, ты должен создать для них разные профили (модели).</p>
                    <p><strong>Зачем?</strong> У них совершенно разные настройки. Если ты попробуешь взлететь на самолете с настройками от квадрокоптера, он разобьется. Всегда проверяй, что на экране выбрана правильная модель (Model 1, Model 2 и т.д.) перед тем, как подключать батарею к дрону.</p>
                    <h2>2. Reverse (Реверс каналов)</h2>
                    <p>Представь: ты двигаешь правый стик (Pitch) вперед, а дрон летит... назад! Это значит, что твой пульт и "мозг" дрона по-разному понимают команду "вперед".</p>
                    <p>Для этого в меню есть функция "Reverse" (Реверс). Ты можешь "перевернуть" любой канал (Газ, Рысканье, Тангаж, Крен).</p>
                    <p>Если дрон реагирует неправильно (влево вместо вправо, вверх вместо вниз), просто зайди в меню "Reverse" и измени этот канал с "Normal" на "Reversed".</p>
                    <p><strong>Важно!</strong> Эту настройку проверяют БЕЗ ПРОПЕЛЛЕРОВ!</p>
                    <h2>3. Trims (Триммеры)</h2>
                    <p>На этом пульте нет физических кнопок-триммеров, как на старых моделях. Тонкая настройка (триммирование) выполняется через <strong>сенсорный экран</strong>.</p>
                    <p>Если ты отпустил правый стик, а дрон все равно медленно летит (дрейфует) вперед, нужно зайти в меню триммеров на экране и сдвинуть ползунок Тангажа (Pitch) "вниз". Это тонкая подстройка, которая помогает дрону висеть на месте идеально ровно.</p>
                `,
                questions: [
                    {
                        question: "1. Ты двигаешь стик 'Крен' (Roll) вправо, а дрон летит влево. Какую настройку в меню пульта нужно проверить?",
                        options: [
                            "А) Model Select",
                            "Б) Reverse",
                            "В) Trims"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. У тебя два разных дрона. Что нужно сделать в пульте?",
                        options: [
                            "А) Использовать один профиль, просто перепривязывать пульт каждый раз",
                            "Б) Создать два разных профиля в меню 'Model Select'",
                            "В) Купить второй пульт"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Твой дрон висит в воздухе, но его медленно сносит вправо, хотя ты не трогаешь стики. Что поможет это исправить 'на лету'?",
                        options: [
                            "А) Нажать кнопку триммера 'Крена' (Roll) влево",
                            "Б) Зайти в меню 'Reverse'",
                            "В) Перезагрузить пульт"
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            // Блок 5
            {
                title: "Блок 5: Переключатели (AUX) и Режимы Полета",
                info: `
                    <p>Мы разобрались со стиками, которые управляют движением дрона. Но у тебя остались "свободные" переключатели: <code>SwA</code>, <code>SwB</code>, <code>SwC</code> и <code>SwD</code> (тумблеры и "крутилки").</p>
                    <p>Они нужны, чтобы включать и выключать разные функции. В мире дронов это называется <strong>"AUX-каналы"</strong> (вспомогательные каналы).</p>
                    <h2>Самая главная функция: Arm/Disarm (Готовность к полету)</h2>
                    <p>Ты не хочешь, чтобы винты дрона начали вращаться сразу, как ты подключил батарею. Это опасно. Поэтому мы назначаем один из тумблеров (например, <code>SwA</code>) на функцию "Arm".</p>
                    <ul>
                        <li><strong>Disarm (Обезоружен/Выключен):</strong> Положение "Выкл" (тумблер от себя). Пульт <strong>продолжает</strong> слать команды, но говорит дрону: "Не реагируй на стик газа и не вращай моторы". Это твой <strong>безопасный режим</strong>.</li>
                        <li><strong>Arm (Готов к полету/Включен):</strong> Положение "Вкл" (тумблер на себя). Пульт посылает команду "Готов". Моторы начнут вращаться на малых оборотах (холостой ход), дрон ждет команды Газа для взлета.</li>
                    </ul>
                    <p class="text-lg font-bold bg-red-800 p-4 rounded-lg"><strong>Золотое правило:</strong> Сразу после посадки или падения — немедленно переведи тумблер в положение "Disarm"! Только после этого можно подходить к дрону.</p>
                    <h2>Другие функции:</h2>
                    <ul>
                        <li><strong>Режимы полета (Flight Modes):</strong> На другой тумблер (например, <code>SwC</code>) можно назначить режимы.</li>
                        <li><strong>Angle (Стабилизация):</strong> Режим для новичков. Если ты отпустишь правый стик, дрон сам себя выровняет параллельно земле.</li>
                        <li><strong>Acro (Акробатика):</strong> Режим для профи. Дрон не выравнивает себя. Как ты его наклонил, так он и летит. Позволяет делать трюки (флипы, роллы).</li>
                        <li><strong>Beeper (Пищалка):</strong> Можно включить громкую пищалку на дроне, если ты потерял его в траве.</li>
                    </ul>
                `,
                questions: [
                    {
                        question: "1. Что такое 'AUX-канал'?",
                        options: [
                            "А) Это главный стик Газа",
                            "Б) Это запасной стик",
                            "В) Это переключатель (тумблер) для включения функций, таких как 'Arm'"
                        ],
                        correctAnswer: 2
                    },
                    {
                        question: "2. Дрон приземлился. Твое первое действие?",
                        options: [
                            "А) Подойти и взять его",
                            "Б) Выключить пульт",
                            "В) Щелкнуть тумблером в положение 'Disarm' (Снять с охраны)"
                        ],
                        correctAnswer: 2
                    },
                    {
                        question: "3. Ты летаешь в режиме 'Angle'. Что произойдет, если отпустить правый стик?",
                        options: [
                            "А) Дрон сам себя выровняет (стабилизируется)",
                            "Б) Дрон продолжит лететь под тем же углом",
                            "В) Дрон выключит моторы"
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            // Блок 6
            {
                title: "Блок 6: Failsafe (Отказоустойчивость)",
                info: `
                    <p>Что произойдет, если дрон улетит слишком далеко, и пульт потеряет с ним связь? Или если в пульте сядет батарейка?</p>
                    <p>Если ничего не настроить, дрон может просто продолжить лететь в последнем направлении (это называется <strong>"Fly-away" — улет</strong>) или хаотично включить моторы. Это очень опасно.</p>
                    <p>Для этого существует настройка <strong>"Failsafe" (Отказоустойчивость)</strong>.</p>
                    <p>Мы должны "объяснить" дрону, что делать, если он потерял сигнал от пульта. Для гоночных и фристайл-дронов (без GPS) самое безопасное решение — <strong>немедленно выключить моторы (Disarm)</strong>.</p>
                    <p><strong>Почему?</strong></p>
                    <p>Лучше дрон упадет там, где он потерял связь (ты будешь знать, где его искать), чем он улетит в неизвестном направлении, разобьется или (что хуже всего) в кого-то врежется.</p>
                    <p>В меню пульта FS-i6S есть раздел "Failsafe". Там нужно убедиться, что для канала, отвечающего за "Arm/Disarm" (например, AUX 1), в режиме потери связи установлено значение "Disarm" (Выкл).</p>
                `,
                questions: [
                    {
                        question: "1. Что такое 'Failsafe'?",
                        options: [
                            "А) Это режим для трюков",
                            "Б) Это то, что делает дрон, когда теряет сигнал от пульта",
                            "В) Это кнопка возврата домой"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Что такое 'Fly-away'?",
                        options: [
                            "А) Когда дрон улетает из-за потери сигнала",
                            "Б) Когда дрон летит очень быстро",
                            "В) Когда дрон выполняет трюк"
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: "3. Какая самая безопасная настройка Failsafe для дрона без GPS?",
                        options: [
                            "А) Заставить дрон лететь вверх",
                            "Б) Продолжать лететь прямо",
                            "В) Немедленно выключить моторы (Disarm) и упасть"
                        ],
                        correctAnswer: 2
                    }
                ]
            },
            // Блок 7
            {
                title: "Блок 7: Батареи, Сигнал и Телеметрия",
                info: `
                    <p>Полет — это постоянный контроль за двумя вещами: зарядом батарей и качеством сигнала.</p>
                    <h2>1. Питание пульта</h2>
                    <p>На экране пульта есть индикатор батареи. Он показывает заряд самого пульта (передатчика). Если этот индикатор мигает — немедленно сажай дрон! Если пульт выключится в полете, ты потеряешь управление (и тут сработает твой Failsafe из Блока 6).</p>
                    <h2>2. Питание дрона (Телеметрия)</h2>
                    <p>Как узнать, что батарея садится на самом дроне?</p>
                    <p>Для этого существует <strong>"Телеметрия"</strong>. Это данные, которые приемник (на дроне) отправляет обратно на твой пульт. FS-i6S умеет ее показывать.</p>
                    <p>В меню <code>[RX Setup] -> [Display]</code> ты можешь включить отображение <strong>"Vbat" (напряжение батареи)</strong>. Это напряжение аккумулятора твоего дрона.</p>
                    <p>Ты можешь настроить "Low voltage alarm" (Сигнал о низком напряжении). Пульт начнет громко пищать, когда батарея дрона будет близка к разрядке.</p>
                    <p class="text-lg font-bold bg-red-800 p-4 rounded-lg"><strong>Золотое правило:</strong> Услышал писк о низком напряжении — НЕМЕДЛЕННО ИДИ НА ПОСАДКУ. Не пытайся выжать "еще 30 секунд". Если батарея сядет в ноль, дрон просто камнем упадет с неба.</p>
                    <h2>3. Антенна</h2>
                    <p>У пульта FS-i6S антенна <strong>встроенная</strong> (она находится внутри верхней части корпуса). У нее нет "кончика", который можно было бы направить на дрон.</p>
                    <p>Главное правило остается: сигнал от пульта самый сильный, когда он направлен на дрон <strong>широкой стороной корпуса</strong> (лицевой или задней), а не <strong>узкой</strong> (верхним или нижним торцом). Старайся не направлять верхний торец пульта (где гнездо для внешней антенны) прямо на модель.</p>
                `,
                questions: [
                    {
                        question: "1. Что такое 'Телеметрия'?",
                        options: [
                            "А) Это программа для настройки дрона на компьютере",
                            "Б) Это данные (например, заряд батареи), которые дрон отправляет обратно на пульт",
                            "В) Это название антенны пульта"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Твой пульт начал громко пищать (Low Voltage Alarm). Что это значит?",
                        options: [
                            "А) Батарея садится в пульте",
                            "Б) Батарея садится на дроне, нужно немедленно садиться",
                            "В) Кто-то звонит тебе на телефон"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Как правильно держать антенну пульта для лучшего сигнала?",
                        options: [
                            "А) Направить кончик антенны прямо на дрон",
                            "Б) Направить боковую сторону антенны на дрон",
                            "В) Спрятать антенну за спину"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 8
            {
                title: "Блок 8: Прежде чем летать — симулятор!",
                info: `
                    <p>Ты готов лететь? Почти. 🚀</p>
                    <p>Было бы обидно разбить дрон в первый же день, правда? Управление дроном требует "мышечной памяти". Твои пальцы должны научиться реагировать автоматически, не задумываясь.</p>
                    <p>Лучший способ этого добиться — <strong>полетный симулятор</strong>. Это компьютерная игра, которая в точности имитирует физику полета дрона.</p>
                    <h2>Как это работает?</h2>
                    <ul>
                        <li>Пульт FS-i6S имеет сзади порт Micro-USB.</li>
                        <li>Ты подключаешь пульт USB-кабелем к компьютеру.</li>
                        <li>Компьютер распознает твой пульт как обычный джойстик (геймпад).</li>
                        <li>Ты запускаешь программу-симулятор (например, DRL Simulator, Liftoff или Velocidrone) и летаешь в виртуальном мире.</li>
                    </ul>
                    <h2>Почему это обязательно?</h2>
                    <ul>
                        <li><strong>Это бесплатно.</strong> Ты можешь "разбивать" дрон тысячи раз, просто нажимая кнопку "Reset".</li>
                        <li><strong>Это безопасно.</strong> Ты никого не травмируешь и ничего не сломаешь.</li>
                        <li><strong>Это эффективно.</strong> 10 часов в симуляторе дадут тебе больше навыков, чем 1 час реальных полетов (и 10 ремонтов).</li>
                    </ul>
                    <p>Твоя цель в симуляторе — научиться уверенно взлетать, висеть на месте, поворачиваться (Yaw) и летать по кругу. Только после того, как ты перестанешь врезаться в виртуальные деревья, можно пробовать летать по-настоящему.</p>
                `,
                questions: [
                    {
                        question: "1. Что такое полетный симулятор?",
                        options: [
                            "А) Это видео-инструкция по ремонту",
                            "Б) Это компьютерная игра для безопасной тренировки полетов",
                            "В) Это функция в пульте для авто-посадки"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Какая главная польза от симулятора?",
                        options: [
                            "А) Он заряжает батарею пульта",
                            "Б) Можно научиться летать, не рискуя сломать настоящий дрон",
                            "В) Он показывает, где можно летать"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Как пульт FS-i6S подключается к компьютеру?",
                        options: [
                            "А) Через Wi-Fi",
                            "Б) С помощью USB-кабеля",
                            "В) Его нельзя подключить к компьютеру"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 9
            {
                title: "Блок 9: Уход за пультом и устранение неполадок",
                info: `
                    <p>Твой пульт — точный и довольно нежный инструмент. Чтобы он служил долго и не подвел в полете, за ним нужно ухаживать.</p>
                    <h2>Правила ухода:</h2>
                    <ul>
                        <li><strong>Береги стики (Gimbals):</strong> Внутри стиков находятся механизмы (гимбалы). Если ты уронишь пульт, они могут повредиться, и дрон начнет "дрейфовать" в полете. Переноси пульт в сумке или кейсе.</li>
                        <li><strong>Береги антенну:</strong> Никогда не используй антенну как ручку для переноски. Если повредить антенну (даже если внешне это незаметно), дальность сигнала резко упадет.</li>
                        <li><strong>Чистота и сухость:</strong> Держи пульт в чистоте. Если летал в пыльном поле, протри его сухой тканью. Никогда не летай под дождем — попадание воды выведет пульт из строя.</li>
                        <li><strong>Хранение:</strong> Не оставляй пульт на палящем солнце (в машине) или на морозе. Если используешь батарейки АА, вынимай их, если не планируешь летать несколько недель (они могут протечь).</li>
                    </ul>
                    <h2>Что делать, если...</h2>
                    <p><strong>Пульт не включается:</strong></p>
                    <ul>
                        <li>Проверь батарейки. Они заряжены?</li>
                        <li>Ты зажимаешь ОБЕ кнопки питания одновременно? (Это частая ошибка новичков).</li>
                    </ul>
                    <p><strong>Дрон не реагирует на стики (не "армится"):</strong></p>
                    <p>"Армиться" (от англ. "Arm") — это процесс, когда ты переключаешь тумблер "Arm" (см. Блок 5), и моторы начинают вращаться на холостом ходу, показывая готовность к взлету. Если этого не происходит:</p>
                    <ul>
                        <li>Ты включил все в правильном порядке? (Сначала Пульт, потом Дрон).</li>
                        <li>Стик газа (левый) в самом нижнем положении? (Пульт не даст "заармить" дрон, если газ не на нуле).</li>
                        <li>Выбрана правильная модель (Model Select) в меню?</li>
                        <li>Пульт и приемник "привязаны" (Binding)?</li>
                    </ul>
                `,
                questions: [
                    {
                        question: "1. Какая часть пульта наиболее уязвима при падении?",
                        options: [
                            "А) Экран",
                            "Б) Стики (гимбалы)",
                            "В) Корпус"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Почему нельзя летать под дождем?",
                        options: [
                            "А) Дрон станет тяжелее",
                            "Б) Вода может вызвать короткое замыкание в пульте или дроне",
                            "В) Сигнал плохо проходит сквозь капли"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Ты пытаешься 'заармить' дрон, но ничего не происходит. Какая наиболее вероятная причина?",
                        options: [
                            "А) Стик газа (левый) не опущен в самое нижнее положение",
                            "Б) Слишком яркое солнце",
                            "В) Слишком слабый ветер"
                        ],
                        correctAnswer: 0
                    }
                ]
            },
            // Блок 10
            {
                title: "Блок 10: Главный чек-лист перед полетом",
                info: `
                    <p>Профессиональные пилоты (даже на больших самолетах) всегда используют чек-лист (контрольный список) перед каждым взлетом. Это помогает убедиться, что все системы в норме и ничего не забыто.</p>
                    <p>Вот твой обязательный чек-лист. Проходи по нему каждый раз перед полетом.</p>
                    <h2>1. Подготовка дома:</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">Батарея дрона (LiPo) заряжена?</li>
                        <li><input type="checkbox" disabled class="mr-2">Батарейки в пульте заряжены?</li>
                        <li><input type="checkbox" disabled class="mr-2">Пропеллеры не повреждены (нет трещин, сколов)?</li>
                        <li><input type="checkbox" disabled class="mr-2">Все болты на дроне затянуты?</li>
                    </ul>
                    <h2>2. На месте (в поле):</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">Место безопасное? (Нет людей, животных, ЛЭП, зданий).</li>
                        <li><input type="checkbox" disabled class="mr-2">Погода хорошая? (Нет дождя, нет сильного ветра).</li>
                    </ul>
                    <h2>3. Включение (СТРОГИЙ ПОРЯДОК):</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">1. ВКЛЮЧИТЬ ПУЛЬТ.</li>
                        <li><input type="checkbox" disabled class="mr-2">Проверить экран: Правильная ли модель (Model Select) выбрана?</li>
                        <li><input type="checkbox" disabled class="mr-2">Проверить тумблеры: Тумблер "Arm" в положении "Disarm" (Выкл)?</li>
                        <li><input type="checkbox" disabled class="mr-2">Проверить стики: Стик газа на нуле (внизу)?</li>
                        <li><input type="checkbox" disabled class="mr-2">2. ПОДКЛЮЧИТЬ БАТАРЕЮ К ДРОНУ. (Положить дрон на ровную землю).</li>
                    </ul>
                    <h2>4. Предполетная проверка:</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">Отойти от дрона на 3-5 метров.</li>
                        <li><input type="checkbox" disabled class="mr-2">Перевести тумблер в положение "Arm" (Вкл).</li>
                        <li><input type="checkbox" disabled class="mr-2">Моторы должны плавно завращаться.</li>
                        <li><input type="checkbox" disabled class="mr-2">Не взлетая, слегка качнуть стики (Pitch, Roll, Yaw) — убедиться, что дрон реагирует на команды.</li>
                    </ul>
                    <h2>5. Полет:</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">Плавный взлет.</li>
                        <li><input type="checkbox" disabled class="mr-2">Внимательно следи за окружением и звуком дрона.</li>
                        <li><input type="checkbox" disabled class="mr-2">Посадка при первом же сигнале о низком заряде батареи (Vbat).</li>
                    </ul>
                    <h2>6. Выключение (СТРОГИЙ ПОРЯДОК):</h2>
                    <ul>
                        <li><input type="checkbox" disabled class="mr-2">1. ОТКЛЮЧИТЬ БАТАРЕЮ ОТ ДРОНА.</li>
                        <li><input type="checkbox" disabled class="mr-2">2. ВЫКЛЮЧИТЬ ПУЛЬТ.</li>
                    </ul>
                `,
                questions: [
                    {
                        question: "1. Что ты должен проверить на экране пульта сразу после его включения, но до подключения дрона?",
                        options: [
                            "А) Правильно ли выбрана модель (Model Select) и находится ли стик газа на нуле",
                            "Б) Время и дату",
                            "В) Яркость экрана"
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: "2. Какой правильный порядок выключения после полета?",
                        options: [
                            "А) Сначала выключить пульт, потом отключить батарею дрона",
                            "Б) Сначала отключить батарею дрона, потом выключить пульт",
                            "В) Не имеет значения, можно одновременно"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Что нужно сделать, если ты услышал писк пульта о низком заряде батареи (Vbat)?",
                        options: [
                            "А) Попробовать выполнить трюк и быстро сесть",
                            "Б) Немедленно и безопасно сажать дрон",
                            "В) Проигнорировать, обычно остается еще 5 минут полета"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 11
            {
                title: "Блок 11: 'Mode 1' vs 'Mode 2' — Особенность стиков FS-i6S",
                info: `
                    <p>Ты мог заметить, что на пульте FS-i6S <strong>ОБА</strong> стика (и левый, и правый) подпружинены и сами возвращаются в центр. <strong>Это не сломано!</strong> Это главная особенность этой модели.</p>
                    <p>Это сделано для удобства управления квадрокоптерами, где центральное положение левого стика означает "0% газа" (дрон не взлетает), а движение вверх — это "дать газу".</p>
                    <h2>Mode 2 (Режим 2) - твой режим</h2>
                    <p>Даже с таким стиком, пульт все равно работает в <strong>Mode 2</strong>, самом популярном режиме:</p>
                    <ul>
                        <li><strong>Левый стик:</strong> Газ (вверх-вниз, с пружиной в центр) и Рысканье (влево-вправо, с пружиной).</li>
                        <li><strong>Правый стик:</strong> Тангаж и Крен (все с пружинами, возвращается в центр).</li>
                    </ul>
                    <h2>А как же стик без пружины?</h2>
                    <p>В "классических" пультах для самолетов левый стик (Газ) не имеет пружины по вертикали и "залипает" в том положении, где ты его оставил. Это удобно для самолетов, чтобы держать постоянную тягу.</p>
                    <p>Твой пульт FS-i6S можно <strong>физически модифицировать</strong> (разобрать корпус и снять пружину/добавить трещотку), чтобы левый стик не пружинил. Но для начала полетов на квадрокоптере стандартный вариант (с пружиной) отлично подходит.</p>
                `,
                questions: [
                    {
                        question: "1. В 'Mode 2' какой стик отвечает за Газ (Throttle)?",
                        options: [
                            "А) Правый стик, движение вверх/вниз",
                            "Б) Левый стик, движение вверх/вниз",
                            "В) Левый стик, движение влево/вправо"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Почему левый стик (Газ) на FS-i6S возвращается в центр?",
                        options: [
                            "А) Он сломан",
                            "Б) Это специальная конструкция этой модели, удобная для квадрокоптеров",
                            "В) Батарейка в пульте села"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Что случится, если твой пульт физически настроен на 'Mode 2', а в симуляторе ты выбрал 'Mode 1'?",
                        options: [
                            "А) Ничего, симулятор сам подстроится",
                            "Б) Управление будет перепутано (например, Газ будет на правом стике), и летать будет невозможно",
                            "В) Управление будет просто немного другим"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 12
            {
                title: "Блок 12: 'Смягчаем' управление: DR и Expo",
                info: `
                    <p>Когда ты только начинаешь, дрон может казаться слишком "дерганым" или "нервным". Малейшее движение пальца — и он уже летит в сторону. Это можно исправить в меню пульта.</p>
                    <p>Для этого есть две волшебные настройки: DR и Expo.</p>
                    <h2>1. Dual Rates (DR) - Двойные Расходы</h2>
                    <p>Эта настройка ограничивает максимальную скорость вращения дрона.</p>
                    <p>Представь, что 100% DR — это "Спортивный режим". Дрон очень резкий.</p>
                    <p>Если ты поставишь DR на 70%, ты как бы включаешь "Спокойный режим". Теперь, даже если ты отклонишь стик до самого упора, дрон будет поворачиваться только на 70% от своей максимальной скорости.</p>
                    <p><strong>Для чего:</strong> Отлично подходит для новичков или для съемки плавного видео.</p>
                    <h2>2. Expo (Экспонента)</h2>
                    <p>Эта настройка делает центр стика менее чувствительным, но оставляет края стика резкими.</p>
                    <p>Представь, что без Expo твой стик — это прямая линия (сколько нажал, столько и получил).</p>
                    <p>Если ты добавишь Expo 30%, центр стика станет "мягким" или "ватным". Ты сможешь очень плавно и точно прицеливаться, делая микродвижения. Но если тебе нужно сделать резкий маневр (например, флип), ты просто доводишь стик до края, и он срабатывает на 100%.</p>
                    <p><strong>Для чего:</strong> Позволяет одновременно и плавно управлять, и сохранять возможность для резких трюков.</p>
                    <p>Для начала попробуй выставить <strong>DR 80%</strong> и <strong>Expo 20-30%</strong>. Это сделает твои первые полеты намного комфортнее.</p>
                `,
                questions: [
                    {
                        question: "1. Твой дрон кажется слишком резким, ты хочешь в целом ограничить его максимальную скорость поворота. Что ты будешь настраивать?",
                        options: [
                            "А) Expo (Экспонента)",
                            "Б) DR (Dual Rates)",
                            "В) Failsafe"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Ты хочешь сделать дрон менее чувствительным в центре стика, чтобы было легче 'виснуть' на месте, но сохранить резкость по краям для трюков. Что ты будешь настраивать?",
                        options: [
                            "А) Expo (Экспонента)",
                            "Б) DR (Dual Rates)",
                            "В) Mode 2"
                        ],
                        correctAnswer: 0
                    },
                    {
                        question: "3. Что такое 'DR 70%'?",
                        options: [
                            "А) Дрон будет слушаться команд только 70% времени",
                            "Б) Дрон будет летать только на 70% от своей максимальной скорости, даже при полном отклонении стика",
                            "В) Центр стика станет на 30% 'мягче'"
                        ],
                        correctAnswer: 1
                    }
                ]
            },
            // Блок 13
            {
                title: "Блок 13: Хват стиков и ремешок",
                info: `
                    <p>Ты готов к полету. Как правильно держать пульт?</p>
                    <p>Во-первых, пульт довольно тяжелый. Если держать его просто в руках, он будет "клевать носом" вниз, и твои руки быстро устанут. Для этого на пульте есть специальное ушко (крепление) по центру.</p>
                    <h2>Шейный ремешок (Neck Strap)</h2>
                    <p>Обязательно используй его. Он крепится к ушку и вешается на шею. Ремешок берет на себя весь вес пульта, освобождая твои руки. Твои кисти расслаблены, и пальцы могут сосредоточиться только на точном управлении.</p>
                    <h2>Два стиля хвата (Grips):</h2>
                    <p><strong>"Щипок" (Pinch):</strong></p>
                    <ul>
                        <li>Ты держишь кончик стика между большим и указательным пальцами (как будто держишь вишенку за черенок).</li>
                        <li><strong>Плюсы:</strong> Считается более точным стилем, так как ты делаешь микродвижения двумя пальцами. Идеально для плавной съемки или точного пилотирования самолетов.</li>
                        <li><strong>Минусы:</strong> Может быть сложнее быстро перебрасывать стик от края до края.</li>
                    </ul>
                    <p><strong>"Пальцы" (Thumbs / Thumbing):</strong></p>
                    <ul>
                        <li>Ты кладешь подушечки больших пальцев прямо на верхушки стиков.</li>
                        <li><strong>Плюсы:</strong> Очень интуитивно (похоже на геймпад от PlayStation или Xbox). Легко и быстро делать резкие движения. Самый популярный стиль у гонщиков и фристайл-пилотов.</li>
                        <li><strong>Минусы:</strong> Некоторым сложнее делать очень мелкие и точные движения.</li>
                    </ul>
                    <p><strong>Какой стиль выбрать?</strong> Попробуй оба! Потренируйся в симуляторе и выбери тот, который удобнее лично тебе. Нет "правильного" или "неправильного" стиля, есть только тот, что подходит тебе.</p>
                `,
                questions: [
                    {
                        question: "1. Для чего нужен шейный ремешок?",
                        options: [
                            "А) Чтобы пульт выглядел круче",
                            "Б) Чтобы освободить руки от веса пульта и повысить точность управления",
                            "В) Чтобы не потерять пульт, если споткнешься"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "2. Пилот управляет дроном, держа стики между большим и указательным пальцами. Как называется этот хват?",
                        options: [
                            "А) 'Пальцы' (Thumbs)",
                            "Б) 'Щипок' (Pinch)",
                            "В) 'Ладонь' (Palm)"
                        ],
                        correctAnswer: 1
                    },
                    {
                        question: "3. Какой стиль хвата считается лучшим для гонок и резких трюков, так как похож на геймпад?",
                        options: [
                            "А) 'Пальцы' (Thumbs)",
                            "Б) 'Щипок' (Pinch)",
                            "В) 'Режим 2'"
                        ],
                        correctAnswer: 0
                    }
                ]
            }
        ];

        // --- ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ И СОСТОЯНИЕ ---
        
        let currentBlockIndex = 0;
        let totalStars = 0;
        let totalPossibleStars = 0;
        // Хранилище для ответов пользователя, чтобы сохранять прогресс
        // Теперь храним объект: { "key": { correct: true/false, selected: 0/1/2 } }
        let userAnswers = {}; 

        // --- DOM ЭЛЕМЕНТЫ ---
        
        const navigationBar = document.getElementById('navigation-bar');
        const contentTitle = document.getElementById('content-title');
        const infoContent = document.getElementById('info-content');
        const quizContent = document.getElementById('quiz-content');
        const starCount = document.getElementById('star-count');
        const starTotal = document.getElementById('star-total');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const tabInfo = document.getElementById('tab-info');
        const tabQuiz = document.getElementById('tab-quiz');
        const infoContainer = document.getElementById('info-container');
        const quizContainer = document.getElementById('quiz-container');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const completionModal = document.getElementById('completion-modal');
        const finalScore = document.getElementById('final-score');
        const restartBtn = document.getElementById('restart-btn');

        // --- ФУНКЦИИ ---

        /**
         * Инициализация курса
         */
        function init() {
            // Считаем общее кол-во звезд
            totalPossibleStars = courseData.reduce((acc, block) => acc + block.questions.length, 0);
            starTotal.textContent = totalPossibleStars;
            
            // Инициализируем хранилище ответов
            userAnswers = {};
            totalStars = 0;

            renderNavigation();
            loadBlock(0);
            updateStarCounter();

            // Навешиваем обработчики
            prevBtn.addEventListener('click', () => changeBlock(-1));
            nextBtn.addEventListener('click', () => changeBlock(1));
            tabInfo.addEventListener('click', () => showTab('info'));
            tabQuiz.addEventListener('click', () => showTab('quiz'));
            startQuizBtn.addEventListener('click', () => showTab('quiz'));
            restartBtn.addEventListener('click', restartCourse);
        }

        /**
         * Переключение вкладок Теория/Тест
         */
        function showTab(tabName) {
            if (tabName === 'info') {
                infoContainer.style.display = 'block';
                quizContainer.style.display = 'none';
                tabInfo.classList.add('active', 'text-blue-400', 'border-blue-400');
                tabInfo.classList.remove('text-gray-400', 'border-transparent', 'hover:border-gray-500');
                tabQuiz.classList.remove('active', 'text-blue-400', 'border-blue-400');
                tabQuiz.classList.add('text-gray-400', 'border-transparent', 'hover:border-gray-500');
            } else {
                infoContainer.style.display = 'none';
                quizContainer.style.display = 'block';
                tabQuiz.classList.add('active', 'text-blue-400', 'border-blue-400');
                tabQuiz.classList.remove('text-gray-400', 'border-transparent', 'hover:border-gray-500');
                tabInfo.classList.remove('active', 'text-blue-400', 'border-blue-400');
                tabInfo.classList.add('text-gray-400', 'border-transparent', 'hover:border-gray-500');
            }
        }

        /**
         * Отрисовка боковой навигации
         */
        function renderNavigation() {
            navigationBar.innerHTML = '<h2 class="text-lg font-semibold mb-4 text-white">Блоки курса</h2>'; // Очистка
            courseData.forEach((block, index) => {
                const button = document.createElement('button');
                button.className = 'nav-button w-full text-left p-3 rounded-lg mb-2 transition duration-300 bg-gray-700 hover:bg-blue-700';
                button.textContent = block.title.split(':')[0]; // "Блок 1"
                button.dataset.index = index;
                button.addEventListener('click', () => loadBlock(index));
                navigationBar.appendChild(button);
            });
        }

        /**
         * Загрузка контента блока (теория + тест)
         */
        function loadBlock(index) {
            currentBlockIndex = index;
            const block = courseData[index];

            // Заполняем теорию
            contentTitle.textContent = block.title;
            infoContent.innerHTML = block.info;

            // Рендерим тест
            renderQuiz(index);
            
            // Обновляем кнопки навигации
            updateNavigationActiveState();
            
            // Показываем/скрываем кнопки "Вперед/Назад"
            prevBtn.style.visibility = index === 0 ? 'hidden' : 'visible';
            nextBtn.style.visibility = index === courseData.length - 1 ? 'hidden' : 'visible';
            
            // Всегда начинаем с вкладки "Теория"
            showTab('info');
            
            // Прокрутка вверх
            document.querySelector('main').scrollTop = 0;
        }

        /**
         * Смена блока (по кнопкам Вперед/Назад)
         */
        function changeBlock(direction) {
            const newIndex = currentBlockIndex + direction;
            if (newIndex >= 0 && newIndex < courseData.length) {
                loadBlock(newIndex);
            }
        }

        /**
         * Обновление активного состояния в боковой навигации
         */
        function updateNavigationActiveState() {
            document.querySelectorAll('.nav-button').forEach(button => {
                if (parseInt(button.dataset.index) === currentBlockIndex) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
        }

        /**
         * Отрисовка вопросов теста для блока
         */
        function renderQuiz(blockIndex) {
            const block = courseData[blockIndex];
            quizContent.innerHTML = ''; // Очистка

            block.questions.forEach((question, qIndex) => {
                const questionKey = `block_${blockIndex}_question_${qIndex}`;

                const questionContainer = document.createElement('div');
                questionContainer.className = 'mb-8 p-4 bg-gray-700 rounded-lg shadow-md';
                questionContainer.dataset.key = questionKey;

                const questionText = document.createElement('h3');
                questionText.className = 'text-lg font-semibold mb-4 text-white';
                questionText.textContent = question.question;
                questionContainer.appendChild(questionText);

                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'space-y-3';

                question.options.forEach((option, oIndex) => {
                    const button = document.createElement('button');
                    button.className = 'option-button block w-full text-left p-3 bg-gray-600 rounded-lg border-2 border-transparent hover:bg-gray-500 transition duration-300';
                    button.textContent = option;
                    button.dataset.isCorrect = (oIndex === question.correctAnswer);
                    
                    button.addEventListener('click', handleAnswerClick);
                    optionsContainer.appendChild(button);
                });

                questionContainer.appendChild(optionsContainer);
                quizContent.appendChild(questionContainer);
                
                // Восстанавливаем состояние, если ответ уже был дан
                if (userAnswers.hasOwnProperty(questionKey)) {
                    const answerData = userAnswers[questionKey];
                    showAnswerResult(questionContainer, answerData.correct, answerData.selected);
                }
            });
        }

        /**
         * Обработка клика по варианту ответа
         */
        function handleAnswerClick(event) {
            const clickedButton = event.target;
            const questionContainer = clickedButton.closest('div[data-key]');
            const questionKey = questionContainer.dataset.key;
            
            // Если на вопрос уже отвечали, ничего не делаем
            if (userAnswers.hasOwnProperty(questionKey)) {
                return;
            }

            const isCorrect = clickedButton.dataset.isCorrect === 'true';
            // Находим индекс нажатой кнопки
            const selectedIndex = Array.from(clickedButton.parentNode.children).indexOf(clickedButton);

            // Сохраняем и правильность, и выбор
            userAnswers[questionKey] = { correct: isCorrect, selected: selectedIndex };
            
            if (isCorrect) {
                totalStars++;
                updateStarCounter();
            }
            
            showAnswerResult(questionContainer, isCorrect, selectedIndex);
            checkCompletion();
        }

        /**
         * Визуальное отображение результата ответа
         * @param {HTMLElement} questionContainer - Контейнер вопроса
         * @param {boolean} isCorrect - Был ли ответ правильным
         * @param {number} selectedIndex - Индекс кнопки, которую нажал/выбрал пользователь
         */
        function showAnswerResult(questionContainer, isCorrect, selectedIndex = null) {
            const buttons = questionContainer.querySelectorAll('.option-button');
            buttons.forEach((button, index) => {
                button.disabled = true; // Блокируем все кнопки
                const buttonIsCorrect = button.dataset.isCorrect === 'true';
                
                if (buttonIsCorrect) {
                    button.classList.add('correct'); // Всегда подсвечиваем правильный
                    if (!button.innerHTML.includes('fa-check-circle')) {
                         button.innerHTML += ' <i class="fas fa-check-circle ml-2"></i>';
                    }
                }
                
                // Если ответ был неверный И это та кнопка, которую выбрали
                if (!isCorrect && selectedIndex === index) {
                    button.classList.add('incorrect');
                     if (!button.innerHTML.includes('fa-times-circle')) {
                        button.innerHTML += ' <i class="fas fa-times-circle ml-2"></i>';
                    }
                }
            });
        }
        
        /**
         * Обновление счетчика звезд
         */
        function updateStarCounter() {
            starCount.textContent = totalStars;
        }

        /**
         * Проверка, пройден ли весь курс
         */
        function checkCompletion() {
            // Проверяем, что количество ответов равно общему числу вопросов
            if (Object.keys(userAnswers).length === totalPossibleStars) {
                 // А теперь проверяем, что все ответы правильные
                if (totalStars === totalPossibleStars) {
                    finalScore.textContent = `⭐ ${totalStars} / ${totalPossibleStars}`;
                    completionModal.classList.remove('hidden');
                }
            }
        }

        /**
         * Перезапуск курса
         */
        function restartCourse() {
            completionModal.classList.add('hidden');
            init(); // Полный сброс
        }

        // --- ЗАПУСК ---
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>



